/*
--|----------------------------------------------------------------------------|
--| FILE DESCRIPTION:
--|   PRNG.h provides the interface for using the Psuedo Random Number Generator.
--|
--|----------------------------------------------------------------------------|
--| REFERENCES:
--|   http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.43.3639
--|
--|----------------------------------------------------------------------------|
*/

/*
--|----------------------------------------------------------------------------|
--| INCLUDE FILES
--|----------------------------------------------------------------------------|
*/

#include "PRNG.h"

/*
--|----------------------------------------------------------------------------|
--| PRIVATE DEFINES
--|----------------------------------------------------------------------------|
*/

/*
--| NAME: PRNG_SEED
--| DESCRIPTION: the PRNG seed
--| TYPE: uint
*/
#define PRNG_SEED (987654321u)

/*
--|----------------------------------------------------------------------------|
--| PRIVATE VARIABLES
--|----------------------------------------------------------------------------|
*/

static uint32_t z1 = PRNG_SEED;
static uint32_t z2 = PRNG_SEED;
static uint32_t z3 = PRNG_SEED;
static uint32_t z4 = PRNG_SEED;

/*
--|----------------------------------------------------------------------------|
--| PUBLIC FUNCTION DEFINITIONS
--|----------------------------------------------------------------------------|
*/

uint16_t PRNG_next_rand(void)
{
    uint32_t b;

    b  = ((z1 << 6u) ^ z1) >> 13u;
    z1 = ((z1 & 4294967294u) << 18u) ^ b;
    b  = ((z2 << 2u) ^ z2) >> 27u; 
    z2 = ((z2 & 4294967288u) << 2u) ^ b;
    b  = ((z3 << 13) ^ z3) >> 21u;
    z3 = ((z3 & 4294967280u) << 7u) ^ b;
    b  = ((z4 << 3u) ^ z4) >> 12u;
    z4 = ((z4 & 4294967168u) << 13u) ^ b;

    return (z1 ^ z2 ^ z3 ^ z4);
}
